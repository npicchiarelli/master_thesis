\documentclass[../../master_thesis_np.tex]{subfiles}
\graphicspath{{./imgs/}}

\begin{document}
	\chapter{Analysis of Structure and Dynamics}
	%Simulations of ABPs ensembles offer an interesting possibility: they make it possible to investigate the physical systems without the limitations that an experimental setup would have. 
	%In simulations it is possible to work in a case with the same number of agents every time, keeping the physical conditions fixed, without all non-idealities, having computational power and time as the only limitation. 
	%This is crucial to study statistical properties of a system that displays fascinating behaviors.
	
	\section{Methods}
	Our investigation in structure and dynamics is based upon a small, but hopefully complete, set of tools that help unveiling how particles place themselves with respect to one another and how do they move {\color{blue} insert citation about 1994 Nobel, "where atoms are, what atoms do"}.
	
		\subsection{Pair Correlation Function}
		Pair correlation function, \emph{radial distribution function}, or simply $g(r)$ describes the variation of density with respect to distance to a reference in a system; it is a function only of the separation $r_{ij} = \abs{\vb{r}_i - \vb{r}_j}$ between any pair of particles. 
		It quantifies how particle in an ensemble position one with respect to each other, giving information about the \emph{structure} of the system. 
		This function plays a key role in physics of matter since it is possible to measure it in radiation-scattering experiments and it is often used in cases where, differently from our problem, particles' positions are not directly accessible.
		
		It is possible to derive definitions for $g(r)$ starting from first principles, like phase-space distribution functions, as it is done in \cite{hansen90a}. 
		Here we will use the Dirac's $\delta$-based expression, since it the most useful in cases where particle's positions are known,
		\begin{equation}
			\left\langle \frac{1}{N} \sum_{i=1}^{N} \sum_{j=1}^{N}{}' \delta (\mathbf{r} - \mathbf{r}_j + \mathbf{r}_i) \right\rangle = \rho g(r)
		\end{equation}
		where the prime on the summation sign means not counting terms with $i = j$. 
		It is possible to show that the left hand side approaches the value of the overall number density $\rho$ at large distance.
		
		In order to compute $g(r)$ in our simulations, we first need to take distances between all pairs of particles (counting twice the same couple) accounting for periodic boundary conditions as any particle became the center of the system, similarly to the periodic interaction method in section \ref{intrange}. 
		Then, to simulate the behavior of a sum of deltas, we divide simulation space in bins by radius, where the area of each bin is computed as the intersection between a circular crown and a square, to respect the geometry of our simulation box without introducing biases. 
		Now we just normalize by the number of particles and the density to make $g(r) \to 1$ at long distance.
		
		\subsection{Polarization}
		Whenever the agents of a system have a preferred axis, as is the case for ABPs, it becomes worthwhile to analyze the order in the orientation degree of freedom of agents. 
		This is useful especially when particles have non symmetric (in some axis) shape. 
		Our particles are assumed to be perfectly symmetrical circles (spheres in 3D), but still, the presence of a well defined swimming direction introduces a relevant anisotropy in the system. 
		
		For global polarization, we use the following definition
		\begin{equation}
			P = \frac{1}{N} \abs{\sum_{k=1}^{N} e^{i \theta_k(t)}} 
		\end{equation}
		where $\theta_k$ is the orientation of $k$-th particle. 
		This parameter is $1$ when all particles directions are aligned and $0$ when all particles are pointing in different directions. 
		
		\subsection{Cluster Size}
		As discussed in section \ref{literature}, ensembles of ABPs tend to cluster when an attractive interaction is present or conditions (velocity, packing fraction) are right for MIPS to occur. 
		In most cases, system clusters as a whole, leaving at most some particles in a gaseous phase outside of the cluster. 
		Observing the evolution of such systems, nonetheless, it is possible to observe long periods of time during which ABPs are only partially clustered, moving in small groups across the simulation boards. 
		
		It is possible to extract some information about partial clusters from the $g(r)$, but, being originally created to study systems a whole, it is not the optimal tool. 
		In order to get some insight about partial clustering, which often happens as a transient state before global clustering, we developed the cluster size analysis. 
		
		Our method was built using DBSCAN, a density-based clustering algorithm, which was originally created for data-science but, with the right parameters, can become useful for physics. 
		DBSCAN starts from a point and adds to the cluster associated with that point all the others which are at a distance of less than a threshold. 
		A point having more than $Mp$ points in its vicinity is said \emph{core point} or \emph{seed}. 
		A point in the vicinity of a \emph{core point} is a \emph{border point}. 
		All the others are \emph{noise points}. 
		Using $1$ as $Mp$ (i.e.\ a cluster must be formed with at least 2 points) and particle radius or interactions range as threshold distance, this algorithm's results correspond to the common sense conception of what a cluster is. 
		The advantage of adapting an existing algorithm is that it has some very fast pre-built implementations which are probably more efficient than one could write from scratch.
		
		\begin{figure}[htp]
			\centering
			\includegraphics[width=.75\textwidth]{dbscan.png}
			\caption{\enquote{Illustration of DBSCAN cluster analysis (minPts=3). Points around A are core points. Points B and C are not core points, but are density-connected via the cluster of A (and thus belong to this cluster). Point N is Noise, since it is neither a core point nor reachable from a core point}. \cite{chire_deutsch_2011}.}
			\label{fig:dbscan}
		\end{figure}
		
		\subsection{Local Polarization}
		As explained in previous section, local properties are useful to observe, in particular in transients. 
		When aligning interactions are present and packing fraction is small or we are in a transient, small clusters of particles tend to align their directions, so that measuring the global polarization $P$ would get in the same result of a disordered system, close to $0$. 
		We can exploit the fact that clustering algorithms assign points to clusters and then measure how polarized the single groups are, meaning we compute a local polarization order parameter. 
		Averaging over clusters, this parameter $\bar{P}$ will be close to $1$ even if $P$ is kept low by the different orientations of clusters, making it a good parameter to study local properties and short range interactions.
		
		\section{Flocking as a Phase Transition}
		As mentioned in section \ref{literature}, \citeauthor{martin-gomez_collective_2018}, as well as \citeauthor{negi_emergent_2022} showed how inserting an explicitly aligning interaction in the simulation can make the whole system polarize, meaning all particles move in the same direction. 
		This phenomenon is called \emph{flocking}.
		
		Here, we show how a repulsive off centered interaction, although with limited range, can lead an ABPs system to reach a flocking state. 
		The selected interaction force is $F(r) = kr^{-2}$, akin to a Coulomb or gravitational force, where $k$ is a constant. 
		When both the off center magnitude $\alpha$ and the constant $k$ have a positive value, front sides of interacting particles repel each other, meaning that two particle swimming towards each other will tend to align their orientations. 
		%Here we stress the fact that when all particles in ensemble have the same velocity and clustering is not present, a head-to-head collision is by far the most frequent, and for sure a head-to-tail collision is almost impossible, since two particles with the same directions will chase each other without ever touching.
		
		\begin{figure}[htp]
			\centering
			\includegraphics[width=\textwidth]{alignment.png}
			\caption{Behavior of two particles with aligning interactions, compared with excluded volume steric interaction only \cite{martin-gomez_collective_2018}.}
			\label{fig:alignment}
		\end{figure}
		
		In Figure \ref{fig:alignment}, an example of how the alignment process works. 
		Differently from our case, the interaction used by \citeauthor{martin-gomez_collective_2018} is an explicitly aligning torque where $T \sim \sin( \theta_{i}-\theta_{j} )$, with particles orientation are \emph{explicitly} included in the expression and $\abs{T}$ has a minimum where $\theta_{i} = \theta_{j}$. 
		Our alignment comes automatically from applying a force to a non centered position. 
		In Figure \ref{fig:flock40}, an example of how flocking transition happens with $k = 10$, with an interaction range of \SI{40}{\micro\meter}.
		\begin{figure}[htp]
			\centering
			\subfloat[][]{\includegraphics[width=.4\textwidth]{coulombrange40/flocking_1.0s.pdf}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{coulombrange40/flocking_5.0s.pdf}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{coulombrange40/flocking_10.0s.pdf}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{coulombrange40/flocking_15.0s.pdf}}\\
		\end{figure}
		\begin{figure}[htp]\ContinuedFloat
			\centering
			\subfloat[][]{\includegraphics[width=.4\textwidth]{coulombrange40/flocking_20.0s.pdf}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{coulombrange40/flocking_25.0s.pdf}}
			
			\caption{Flocking transition: all particles in the system tend to polarize after few seconds. Images a, b, c, d, e, f correspond to situation after \qtylist{1;5;10;15;20;25}{\second}}
			\label{fig:flock40}
		\end{figure}
		
		\subsection{Methods}	
		We studied flocking as a II order phase transition, using the global polarization $P$ as order parameter and varying $\alpha$, to change the magnitude of orientations coupling. 
		The range of interaction is \SI{5}{\micro\meter}, which, being $2.5R$, with $R$ particle radius, is enough to make particles interact only with one layer of particles around them, simulating a nearest-neighbor interaction. 
		Though interactions range is so short, a long-range order establishes for large enough $\alpha$, making the whole ensemble polarize.
		
		Integration step is \SI{5e-2}{\second} and simulation is \num{2e5} steps long, for a resulting simulation time of \SI{e4}{\second}, enough to let the system thermalize and reach a steady state as shown in Figure \ref{fig:polar_therm}.
		For each parameter set, we performed one simulation only: in this aspect, our analysis differs from the one done by \citeauthor{martin-gomez_collective_2018}, where means and standard deviations are computed over independent realizations.
		We believe that, with fixed simulation time, making one longer simulation is more convenient than more shorter ones, since the system has to thermalize only once, letting us waste less data.
		When everything is done in one simulation, some resampling technique is required to compute an estimate of the error as will be explained shortly.
		We proceeded to analyze data as follows: after discarding the first \num{2e4} steps as thermalization, polarization history is treated using a blocking and then a JackKnife resampling.
		
		\begin{figure}[htp]
			\centering
			\includegraphics[width= \singfigwidth]{phasetrans/thermalization_v10.pdf}
			\caption{History of polarization for $v = \SI{10}{\um\per\second}$, and several values of the off center coupling. Black dashed line is the number of points we discarded.}
			\label{fig:polar_therm}
		\end{figure}
		
		Blocking means grouping all the history in subsets of subsequent points and replacing each of them with their average.
		This process is executed in order to compute an estimate of the standard deviation for observables of interest, calculating it as if each block was independent from the others. 
		Choosing the block size is a matter of discussion: a large size will result in blocks with smaller correlation, but the small number of the obtained bins will make oscillations larger. 
		In theory, the value of the standard deviation will saturate to its \emph{real} value increasing the size, but in reality one has to make some trade off between oscillations and auto-correlation.

		Blocking only won't solve the fact that all data comes from the same sample.
		In order to have good estimators for means and variances of relevant observables we need a resampling technique, such as the well-known Boootstrap or, as we used, JackKnife, where we replace each point with the mean of all the other points in the history.
		Resulting sample standard deviations for polarization and susceptivity are plotted in Figure \ref{fig:blocksize} as a function of block size.
		
		\begin{figure}[htp]
			\centering
			\includegraphics[width= \singfigwidth]{phasetrans/blocksize_v10.pdf}
			\caption{Standard deviation of polarization and susceptivity versus blocking size. Black dashed line is the block size of 2500 points that was used for this work. For this plot, $v = \SI{10}{\um\per\second}$, $\alpha = 0.25$.}.
			\label{fig:blocksize}
		\end{figure}

		
		\subsection{Results}
		As a result, Figure \ref{fig:phasetrans} shows the expected behavior of a II order phase transition: as the order parameter $P$ gets with a discontinuity from 0 to 1, its susceptibility diverges to a peak when $\alpha$ approaches critical value and then returns back close to zero (see, as a reference, Figure \ref{fig:martin_flocking3}).
		
		\begin{figure}[htp]
			\centering
			\includegraphics[width= \singfigwidth]{phasetrans/pol_susc.pdf}
			\caption{Diagrams for polarization and relative susceptivity for the transition to ordered phase.}
			\label{fig:phasetrans}
		\end{figure}
		
		\section{Clustering and Local Order}
		Lennard Jones (LJ) is the potential which has the best chance of representing well real world dynamics (see section \ref{qualitative}), so it is worthwhile to study it in detail, to see how it affects individual and collective behaviors of ABPs ensembles. 
		In order to do that, we investigated both global and local polarization, as well as clustering, to better understand the effects of the different model parameters on both positional and orientational degrees of freedom.
		As discussed in section \ref{qualitative}, in reality not all particles move with the same self-propulsion velocity because of imperfections in fabrication processes.
		For the same reason, some particles show a nonzero angular velocity that makes their dynamics more well-explained by a chiral Brownian motion \cite{callegari_numerical_2019}.
		Thus, to better resemble reality, we added aforementioned features in simulations, and then studied how such features can change collective behaviors of an ensemble of self-propelled particles.
		
		In the following, where not differently reported, the interaction used is Lennard Jones with parameters $\sigma = 2R$, with $R$ particle's radius, and strength parameter $\epsilon \sigma = \SI{0.1}{\micro\joule}$.
		Simulations involved $250$ particles with $R = \SI{2}{\um}$ in a square of \SI{175}{\um} side, for a resulting packing fraction of $\sim 0.1$.
		Simulation time is 1000 s but shorter times are showed in graphs as needed.
		Integration step can vary with parameters, to ensure the best trade-off between stability in the simulations and execution speed, but for most simulations \SI{5e-3}{\second} was chosen as integration interval and when different values are used they are declared in sections.
		
		For every parameters set, we simulated five different starting conditions, randomly generated.
		When distributions are involved in the simulation, e.g.\ for linear and angular velocity, probability distribution functions are resampled at every repetition.
		For cluster size and number, as well as polarizations, lines in graphs are averages of those five simulations, with ribbons around them represent standard deviations around the mean.
		{\color{blue} Radial distribution functions are plotted for the final instant of just one of the simulations.}
		Transient time for polarization is measured as the time it takes for this order parameter to reach \num{95} \% of its maximum.
		
		\subsection{Velocity}
		\label{velocity}
		In order to study the effect of velocity, we first computed all the quantities of interest in the case of passive particles with an aligning LJ interaction, and then added a self propulsion velocity. 
		An active speed makes the system non-isotropic, giving a preferred direction to particles, so we also investigated how velocity interacts with the sign of the directional coupling parameter $\alpha$, repeating the analysis for positive and negative values of it.
		
		In Figure \ref{fig:lj_velocity_pol} it is noticeable how an ensemble of passive particles with an aligning interaction has a baseline local polarization, while the global is almost zero. 
		Adding self-propulsion has the consequence of making the system polarize, with a transient length that depends on the velocity: faster particles tend to align faster. 
		A noteworthy characteristic is that particles with interacting position on the back do not tend to align at all.
		
		This can also be noticed in Figures \ref{fig:lj_velocity_situa} and \ref{fig:lj_velocity_cluster}, where, when the off center position is on the back, velocity tends to hinder clustering, leading to a more sparse final situation. 
		This can be due to the aforementioned fact about velocity: all particles have the same velocity so a head-to-tail collision is unlikely, as a consequence the interacting positions of two contacting particles will always be at a distance $>2R$ where interaction is pretty weak.
		Radial distribution functions in Figure \ref{fig:lj_velocity_rdf} show how a particles which swim with their interacting position on the back tend to develop less long range order, regardless their velocity.
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/situa10.0_oc0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/situa20.0_oc0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/situa10.0_oc-0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/situa20.0_oc-0.5.png}}\\
			
			\caption{Representative simulation snapshots corresponding to values of velocity and $\alpha$: (a) $v = \SI{10}{\um \per \second} \alpha = 0.5$, (b) $v = \SI{20}{\um \per \second} \alpha = 0.5$, (c) $v = \SI{10}{\um \per \second} \alpha = -0.5$, (d) $v = \SI{20}{\um \per \second} \alpha = -0.5$}
			\label{fig:lj_velocity_situa}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/polar10.0_oc0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/polar20.0_oc0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/polar10.0_oc-0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/polar20.0_oc-0.5.png}}\\
			
			\caption{Local (blue) and global (green) polarization corresponding to values of velocity and $\alpha$: (a) $v = \SI{10}{\um \per \second} \alpha = 0.5$, (b) $v = \SI{20}{\um \per \second} \alpha = 0.5$, (c) $v = \SI{10}{\um \per \second} \alpha = -0.5$, (d) $v = \SI{20}{\um \per \second} \alpha = -0.5$.}
			\label{fig:lj_velocity_pol}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/cluster10.0_oc0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/cluster20.0_oc0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/cluster10.0_oc-0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/cluster20.0_oc-0.5.png}}\\
			
			\caption{Maximum cluster size and number of clusters corresponding to values of velocity and $\alpha$: (a) $v = \SI{10}{\um \per \second} \alpha = 0.5$, (b) $v = \SI{20}{\um \per \second} \alpha = 0.5$, (c) $v = \SI{10}{\um \per \second} \alpha = -0.5$, (d) $v = \SI{20}{\um \per \second} \alpha = -0.5$.}
			\label{fig:lj_velocity_cluster}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/rdf10.0_oc0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/rdf20.0_oc0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/rdf10.0_oc-0.5.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_velocity/rdf20.0_oc-0.5.png}}\\
			
			\caption{Radial distribution function at last instant of simulation corresponding to values of velocity and $\alpha$: (a) $v = \SI{10}{\um \per \second} \alpha = 0.5$, (b) $v = \SI{20}{\um \per \second} \alpha = 0.5$, (c) $v = \SI{10}{\um \per \second} \alpha = -0.5$, (d) $v = \SI{20}{\um \per \second} \alpha = -0.5$.}
			\label{fig:lj_velocity_rdf}
		\end{figure}
		\subsection{Velocity Distribution}
		A simple way to add some complexity into the model is not to generate all particles with the same velocity, but to initialize them with their self propulsion speed constant but sampled from some distribution. 
		This way collisions are more likely and in a greater variety of directions' configurations.
		
		In order to study the effect of a velocity distribution in an ABPs ensemble, we performed simulations generating velocities from a normal distribution, keeping the mean constant at \SI{10}{\um \per \second} and changing the standard deviation in \qtylist{1; 2; 5; 10}{\um \per \second}.
		To avoid having particles that swim backwards with respect to their self propulsion direction, random speeds are actually generated from a truncated distribution with a cutoff at \SI{0}{\um \per \second}.
		
		Considerations about collisions could lead to the expectation that, with a velocity distribution, particles will cluster more easily in a MIPS fashion.
		In fact, both cluster size and $g(r)$ (Figures \ref{fig:lj_vdist_clust} and \ref{fig:lj_vdist_rdf}) show how adding different velocities to the system tends to hinder packing, leading in the end to a more sparse system.
		
		From the polarization standpoint, increasing the broadness of the distribution tends to slightly reduce the amount of total alignment in the system, while local polarization remains higher. 
		An interesting fact is that, although alignment and clustering are often related, here a drastic downfall of clustering does not reflect in a big difference in polarization, resulting in a sparse system with a remarkable amount of alignment.
		This is immediately noticeable, in addition to the graphs in Figures \ref{fig:lj_vdist_pol} and \ref{fig:lj_vdist_clust}, in the snapshot in panel (d) of Figure \ref{fig:lj_vdist_situa}.
		As seen in previous section, faster velocities make transient times shorter and this case makes no exception.
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/situa1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/situa2.0.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/situa5.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/situa10.0.png}}\\
			
			\caption{Representative simulation snapshots for a normal velocity distribution with $\mu = \SI{10}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{1}{\um\per\second}$, (b) $\sigma = \SI{2}{\um\per\second}$, (c) $\sigma = \SI{5}{\um\per\second}$, (d) $\sigma = \SI{10}{\um\per\second}$}
			\label{fig:lj_vdist_situa}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/polar1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/polar2.0.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/polar5.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/polar10.0.png}}\\
			
			\caption{Local (blue) and global (green) polarization for a normal velocity distribution with $\mu = \SI{10}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{1}{\um\per\second}$, (b) $\sigma = \SI{2}{\um\per\second}$, (c) $\sigma = \SI{5}{\um\per\second}$, (d) $\sigma = \SI{10}{\um\per\second}$}
			\label{fig:lj_vdist_pol}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/cluster1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/cluster2.0.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/cluster5.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/cluster10.0.png}}\\
			
			\caption{Maximum cluster size and number of clusters for a normal velocity distribution with $\mu = \SI{10}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{1}{\um\per\second}$, (b) $\sigma = \SI{2}{\um\per\second}$, (c) $\sigma = \SI{5}{\um\per\second}$, (d) $\sigma = \SI{10}{\um\per\second}$}
			\label{fig:lj_vdist_clust}
		\end{figure}
		
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/rdf1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/rdf2.0.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/rdf5.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_vdist/rdf10.0.png}}\\
			
			\caption{Radial distribution function at last instant of simulation for a normal velocity distribution with $\mu = \SI{10}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{1}{\um\per\second}$, (b) $\sigma = \SI{2}{\um\per\second}$, (c) $\sigma = \SI{5}{\um\per\second}$, (d) $\sigma = \SI{10}{\um\per\second}$.}
			\label{fig:lj_vdist_rdf}
		\end{figure}
		
		\subsection{Orientation Coupling}
		To understand the role of the orientational coupling parameter $\alpha$, we performed simulations with velocity \SI{20}{\um\per\second}, varying $\alpha$ between \numlist{-0.75; 0.75} in \num{0.25} increments. 
		Here, a large magnitude of the coupling with positive sign means making the interacting positions of two particles closer when they are moving towards each other in a head to head fashion.
		For this reason, when $\alpha = 0.75$, integration step is decreased to \SI{2.5e-4}{\second} to avoid instabilities due to the LJ nonlinearity.
		
		Results relative to \num{0} coupling show how clustering and polarization are related in this case: not only the absence of an alignment interaction hinders system's polarization as expected, but at this level, large scale clustering does not realize although an attractive force is inserted in simulations.
		
		With $\alpha = 0.25$ system tends to polarize, both locally and globally, but still it does not cluster as a whole. 
		Some peaks at short distance start to rise in the $g(r)$ (Figure \ref{fig:lj_oc_rdf}), showing the onset of short range order, though they are not in the typical positions of a hexagonal close packed lattice.
		
		At $\alpha = 0.5$ polarization is almost total and all particles in the system tend to be part of the same cluster.
		Radial distribution function shows the onset of long range order, with high and narrow peaks, both at short and long distance.
		
		Polarization is total at $\alpha = 0.75$, and once steady state is reached, both local and global alignment present very small oscillations.
		Ensemble is fully clustered and flocking at this point.
		
		Analyzing the transient time, it is possible to notice how increasing the coupling parameter between orientation angles tends to reduce the transient time, making it faster for the system to align (Figure \ref{fig:transienttime_oc}).
		\begin{figure}[htp]
			\centering
			\includegraphics[width = \singfigwidth]{lj_oc/transient_time_alpha.pdf}
			
			\caption{Transient time (time needed to reach 95\% of maximum) for global polarization as a function of $\alpha$. Only positive values of off center coupling (where the system polarizes) are showed here.}
			\label{fig:transienttime_oc}
		\end{figure}
		
		All of the three simulations with negative $\alpha$ show no alignment and no clustering, in accordance with what stated in section \ref{velocity}.
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa-0.75.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa-0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa-0.25.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa0.0.png}}\\
		\end{figure}
		\newpage
		\begin{figure}[htp]\ContinuedFloat
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa0.25.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_oc/situa0.75.png}}
			
			\caption{Representative simulation snapshots corresponding to values of off center parameter $\alpha$: (a) $\alpha = -0.75$, (b) $\alpha = -0.5$, (c) $\alpha = -0.25$, (d) $\alpha = 0$, (e) $\alpha = 0.25$, (f) $\alpha = 0.5$, (g) $\alpha = 0.75$}
			\label{fig:lj_oc_situa}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar-0.75.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar-0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar-0.25.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar0.0.png}}\\
		\end{figure}
		
		\begin{figure}[htp]\ContinuedFloat
			\centering
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar0.25.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/polar0.75.png}}
			
			\caption{Local (blue) and global (green) polarization for corresponding to values of off center parameter $\alpha$: (a) $\alpha = -0.75$, (b) $\alpha = -0.5$, (c) $\alpha = -0.25$, (d) $\alpha = 0$, (e) $\alpha = 0.25$, (f) $\alpha = 0.5$, (g) $\alpha = 0.75$}
			\label{fig:lj_oc_pol}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster-0.75.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster-0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster-0.25.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster0.0.png}}\\
		\end{figure}
		
		\begin{figure}\ContinuedFloat
			\centering
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster0.25.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/cluster0.75.png}}
			
			\caption{Maximum cluster size and cluster number corresponding to values of off center parameter $\alpha$: (a) $\alpha = -0.75$, (b) $\alpha = -0.5$, (c) $\alpha = -0.25$, (d) $\alpha = 0$, (e) $\alpha = 0.25$, (f) $\alpha = 0.5$, (g) $\alpha = 0.75$}
			\label{fig:lj_oc_clust}
		\end{figure}
		
				\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf-0.75.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf-0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf-0.25.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf0.0.png}}\\
		\end{figure}
		
		\begin{figure}\ContinuedFloat
			\centering
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf0.25.png}}
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.5\textwidth]{lj_oc/rdf0.75.png}}
			
			\caption{Radial distribution function at last instant of simulation corresponding to values of off center parameter $\alpha$: (a) $\alpha = -0.75$, (b) $\alpha = -0.5$, (c) $\alpha = -0.25$, (d) $\alpha = 0$, (e) $\alpha = 0.25$, (f) $\alpha = 0.5$, (g) $\alpha = 0.75$}
			\label{fig:lj_oc_rdf}
		\end{figure}
	
		
		\subsection{Angular Velocity}
		Simulations relative to this section are performed with a Lennard Jones strength parameter of $\epsilon \sigma = \SI{0.25}{\micro\joule}$.
		The influence of rotational self propulsion was studied generating particles' angular velocity from a normal distribution.
		To avoid inserting a bias in the system the mean is kept fixed at \SI{0}{\radian\per\second}, while changing the standard deviation in \qtylist{0.5; 1;2}{\radian\per\second}.
		This simulations tend to be less stable than ones without angular velocity, thus we needed to decrease the integration step to \SI{2.5 e-3}{\second}.
		
		With a \SI{0.5}{\radian\per\second} standard deviation, global polarization is strongly hindered, with large oscillations, though still showing an increasing trend.
		Still, local polarization remains above baseline.
		Cluster size presents an increasing trend as well, {\color{blue} and probably a longer simulation is needed to reach steady state}.
		Some peaks are still present in radial distribution function, a sign that some order is preserved in the system, at least at short and medium range.
		
		A standard deviation of \SI{1}{\radian\per\second} destroys global orientational order almost completely, while local polarization is just above the initial value.
		Situation plot in panel (b) of Figure \ref{fig:lj_av_situa} shows a system with relatively small oriented clusters; as a consequence, $g(r)$ peaks are lower than before and in a much smaller number.
		
		Further broadening the angular velocity distribution makes it impossible for the ensemble to develop long range order, as $g(r)$ shows.
		Polarization is completely hindered as well, both locally and globally, as graphs and situation plots show.
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/situa0.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/situa0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/situa1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/situa2.0.png}}\\
			
			\caption{Representative simulation snapshots for a normal angular velocity distribution with $\mu = \SI{0}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{0}{\um\per\second}$, (b) $\sigma = \SI{0.5}{\um\per\second}$, (c) $\sigma = \SI{1}{\um\per\second}$, (d) $\sigma = \SI{2}{\um\per\second}$}
			\label{fig:lj_av_situa}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/polar0.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/polar0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/polar1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/polar2.0.png}}\\
			
			\caption{Local (blue) and global (green) polarization for a normal angular velocity distribution with $\mu = \SI{0}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{0}{\um\per\second}$, (b) $\sigma = \SI{0.5}{\um\per\second}$, (c) $\sigma = \SI{1}{\um\per\second}$, (d) $\sigma = \SI{2}{\um\per\second}$}
			\label{fig:lj_av_pol}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/cluster0.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/cluster0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/cluster1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/cluster2.0.png}}\\
			
			\caption{Maximum cluster size and cluster number for a normal angular velocity distribution with $\mu = \SI{0}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{0}{\um\per\second}$, (b) $\sigma = \SI{0.5}{\um\per\second}$, (c) $\sigma = \SI{1}{\um\per\second}$, (d) $\sigma = \SI{2}{\um\per\second}$}
			\label{fig:lj_av_clust}
		\end{figure}
		
		\begin{figure}[htp]
			\centering\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/rdf0.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/rdf0.5.png}}\\
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/rdf1.0.png}}
			\subfloat[][]{\includegraphics[width=.4\textwidth]{lj_av/rdf2.0.png}}\\
			
			\caption{Radial distribution function at last instant of simulation for a normal angular velocity distribution with $\mu = \SI{0}{\um\per\second}$ and standard deviation: (a) $\sigma = \SI{0}{\um\per\second}$, (b) $\sigma = \SI{0.5}{\um\per\second}$, (c) $\sigma = \SI{1}{\um\per\second}$, (d) $\sigma = \SI{2}{\um\per\second}$}
			\label{fig:lj_av_rdf}
		\end{figure}
		
    \section{Conclusions to chapter 3}
    Along this chapter we studied how our model can be used in a theoretical investigation of both phase transitions and collective behaviors.
    We showed that, without an explicitly aligning torque, our system undergoes a flocking transition, similar to what happens with original or continuous Vicsek models that have been built for that purpose.
    Such a phenomenon can be efficiently studied as a continuous phase transition, where the order parameter shows the expected behavior.
    
    Regarding the effect of simulation features on collective behaviors we showed that, in general, adding more complexity with some angular or linear velocity distribution tends to disrupt long range order in positions, while the presence of larger velocities (both in the case of one velocity and distributions) has the tendency to align the system, with faster particles spreading information across the board.
    In general, positional and orientational order are related when the same velocity is applied to all particles and a clustered system is a flocking system in most cases.
    
    We can conclude that the suite of tools we developed offer a fast and efficient way to study at least some of the collective behaviors featured in a systems like the one we are interested in.
    Though not complete, this set of parameters can reveal more insights about ensembles of ABPs.
    \end{document}